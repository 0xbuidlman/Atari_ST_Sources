/******************************************************************/
/******************************************************************/
#include <stdio.h>
#include <cookie.h>
#include <osbind.h>

/******************************************************************/
/******************************************************************/
#define FAIL -1
#define NOLL 0

/******************************************************************/
/******************************************************************/
typedef struct RSVF_OBJECT
{
	char          *name;
    unsigned char	func,
                    niu0,
                    dev_num,
                    niu1;     
}RSVF_OBJECT;

/******************************************************************/
/******************************************************************/
RSVF_OBJECT *port[10];

/******************************************************************/
/******************************************************************/
void main(void)
{
  init_rsvf();
  test();
}

/******************************************************************/
/******************************************************************/
void init_rsvf(void)
{
  RSVF_OBJECT *object;
  int temp=NOLL;
  if(getcookie(RSVF,(long *)&object))
  {
//printf("Debug: RSVF Cookie Found\n");
    while(object!=NULL)
    {
      port[temp]=object;
      object++,temp++;
      if(!(object->func&128))
        object=(RSVF_OBJECT *)object->name;
    }
    
  }
  port[temp]=NULL;
}

/******************************************************************/
/******************************************************************/
void test(void)
{
  char tecken;

  Bconout(7,'A');
  Bconout(7,'T');
  Bconout(7,'\n');
  while(!kbhit())
  {
    if(Bconstat(7)==FAIL)
    {
      tecken=Bconin(7);
      putch(tecken);  
    }
  }

}