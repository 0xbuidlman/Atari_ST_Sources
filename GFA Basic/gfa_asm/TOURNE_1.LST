' Tourne_1.lst
' pour faire tourner un graphique d'un angle quelconque
' -----------------------------------------------------
' cr‚ation du graphique
DEFFILL 1,3,8
PBOX 1,1,208,48
DEFTEXT 1,0,0,26
TEXT 13,36,"GFA - BASIC"
'
' offset du coin sup‚rieur gauche
x%=1
y%=1
' largeur et hauteur
w%=208
h%=48
' angle de rotation, en degr‚s (trigonom.)
tour%=45
rayon=tour%*PI/180
'
' sauvegarde du graphique
GET x%,y%,x%+w%-1,y%+h%-1,s$
s%=VARPTR(s$)+6
'
' longueur en octets du graphique en format GET (compl‚tion au
' mot)
xb%=((w%+15) DIV 16)*2
'
t=TIMER
'
' la destination est toujours l'‚cran
'
' l'adresse du stockage interm‚diaire correspond au coin
' inf‚rieur gauche de l'‚cran
dh%=XBIOS(2)+80*399
'
' afficher le graphique tourn‚ dans le milieu
xm%=320-((h%-1)*SIN(rayon)+(w%-1)*COS(rayon))/2+0.5
ym%=200-((h%-1)*COS(rayon)-(w%-1)*SIN(rayon))/2+0.5
' faire disparaŒtre temporairement la souris (gain de temps)
HIDEM
' poser une bande en bas de l'‚cran, calculer coordonn‚es
' polaires
' afficher le point de rotation … l'‚cran
FOR y0=0 TO h%-1+2/3 STEP 2/3
  BMOVE s%+INT(y0)*xb%,dh%,xb%
  FOR x0=0 TO w%-1+2/3 STEP 2/3
    yk%=ym%+y0*COS(rayon)+0.5-x0*SIN(rayon)
    COLOR POINT(x0,399)
    IF yk%<399
      xk%=xm%+y0*SIN(raxon)+0.5+x0*COS(rayon)
      IF yk%>=0 AND xk%>=0 AND xk%<=639
        PLOT xk%,yk%
      ENDIF
    ENDIF
  NEXT x0
NEXT y0
'
' effacer la ligne inf‚rieure en bas de l'‚cran
COLOR 0
LINE 0,399,639,399
COLOR 1
SHOWM
'
tt=(TIMER-t)/200
t$=STR$(tt)
'
ALERT 1,"En GFA Basic, |le graphique tourne en|"+t$+"secondes.",1," OK ",d%
'
EDIT
