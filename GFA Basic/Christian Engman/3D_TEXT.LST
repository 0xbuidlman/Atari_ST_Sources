' 3D-text
' G”r egna bokst„ver med tex CHAREDIT.LST
ON BREAK GOSUB exit
ON ERROR GOSUB exit
@init.screens
@set.cols
chars%=40               ! Number of characters
@init.cords
DO
  FOR p%=0 TO chars%
    IF LEN(INKEY$)
      @exit
    ENDIF
    x.rot=180*COSQ(v%/3)
    y.rot=180*SINQ(v%/2)
    z.rot=180*COSQ(v%/4)
    @swap.screens
    @draw.vector(p%,0,0,-100,x.rot,y.rot,z.rot)
    ADD v%,10
  NEXT p%
LOOP
@exit
'
'
'
> PROCEDURE init.screens
  HIDEM
  DIM scr|(32255)
  scr1%=XBIOS(3)
  scr2%=ARRPTR(scr|())+255 AND &HFFFF00
  SGET c$
RETURN
> PROCEDURE swap.screens
  SWAP scr1%,scr2%
  ~XBIOS(5,L:scr1%,L:scr2%,-1)
  VSYNC
  SPUT c$
RETURN
> PROCEDURE init.cords
  DIM pnts%(chars%),x%(chars%,18),y%(chars%,18),z%(chars%,18)
  DIM px%(19),py%(19)
  FOR p%=0 TO chars%
    READ pnts%(p%)
    FOR n%=0 TO pnts%(p%)
      READ x%(p%,n%),y%(p%,n%),z%(p%,n%)
    NEXT n%
  NEXT p%
RETURN
> PROCEDURE draw.vector(p%,x.offs,y.offs,z.offs,ax,ay,az)
  sinx=SINQ(ax)
  cosx=COSQ(ax)
  siny=SINQ(ay)
  cosy=COSQ(ay)
  sinz=SINQ(az)
  cosz=COSQ(az)
  FOR n%=0 TO pnts%(p%)
    '
    x%=x%(p%,n%)+p2%*40
    y%=y%(p%,n%)
    z%=z%(p%,n%)
    x2=x%*cosz+y%*sinz
    y2=y%*cosz-x%*sinz
    z2=z%*cosy+x2*siny
    x%=x2*cosy-z%*siny+x.offs
    y%=y2*cosx+z2*sinx+y.offs
    z%=z2*cosx-y2*sinx+z.offs
    fact=200/(200+z%)
    px%(n%)=160+x%*fact
    py%(n%)=100-y%*fact
    '
  NEXT n%
  px%(n%)=px%(0)
  py%(n%)=py%(0)
  POLYLINE ADD(pnts%(p%),2),px%(),py%()
RETURN
> PROCEDURE set.cols
  VSETCOLOR 0,0
  VSETCOLOR 1,7,7,7
RETURN
> PROCEDURE exit
  VSETCOLOR 0,7,7,7
  VSETCOLOR 1,0,0,0
  EDIT
RETURN
'
> PROCEDURE data
  ' (
  DATA 9, 15,20,0, 15,10,0, 5,10,0, 5,-10,0, 15,-10,0, 15,-20,0, 0,-20,0, -5,-15,0, -5,15,0, 0,20,0
  ' )
  DATA 9, -15,20,0, 0,20,0, 5,15,0, 5,-15,0, 0,-20,0, -15,-20,0, -15,-10,0, -5,-10,0, -5,10,0, -15,10,0
  ' .
  DATA 3, -15,-10,0, -5,-10,0, -5,-20,0, -15,-20,0
  ' ,
  DATA 5, -15,-10,0, -5,-10,0, -5,-20,0, -10,-25,0, -10,-20,0, -15,-20,0
  ' '
  DATA 5, -5,20,0, 5,20,0, 5,10,0, 0,5,0, 0,10,0, -5,10,0
  ' /
  DATA 5, -15,-15,0, 5,20,0, 15,20,0, 15,15,0, -5,-20,0, -15,-20,0
  ' 1
  DATA 9, -15,20,0, 5,20,0, 5,-10,0, 15,-10,0, 15,-20,0, -15,-20,0, -15,-10,0, -5,-10,0, -5,10,0, -15,10,0
  ' 2
  DATA 13, -15,20,0, 10,20,0, 15,15,0, 15,0,0, 10,-5,0, -5,-5,0, -5,-10,0, 15,-10,0, 15,-20,0, -15,-20,0, -15,5,0, 5,5,0, 5,10,0, -15,10,0
  ' 3
  DATA 16, -15,20,0, 10,20,0, 15,15,0, 15,5,0, 10,0,0, 15,-5,0, 15,-15,0, 10,-20,0, -15,-20,0, -15,-10,0, 5,-10,0, 5,-5,0, -10,-5,0, -10,5,0, 5,5,0, 5,10,0, -15,10,0
  ' 4
  DATA 9, -15,20,0, -5,20,0, -5,5,0, 5,5,0, 5,20,0, 15,20,0, 15,-20,0, 5,-20,0, 5,-5,0, -15,-5,0
  ' 5
  DATA 13, 15,20,0, -15,20,0, -15,-5,0, 5,-5,0, 5,-10,0, -15,-10,0, -15,-20,0, 10,-20,0, 15,-15,0, 15,0,0, 10,5,0, -5,5,0, -5,10,0, 15,10,0
  ' 6
  DATA 15, 15,20,0, 15,10,0, -5,10,0, -5,-10,0, 5,-10,0, 5,-5,0, 0,-5,0, 0,5,0, 10,5,0, 15,0,0, 15,-15,0, 10,-20,0, -10,-20,0, -15,-15,0, -15,15,0, -10,20,0
  ' 7
  DATA 6, -15,20,0, 10,20,0, 15,15,0, 15,-20,0, 5,-20,0, 5,10,0, -15,10,0
  ' 8
  DATA 13, -15,-20,0, -15,20,0, 15,20,0, 15,-20,0, 0,-20,0, 0,-10,0, 5,-10,0, 5,-5,0, 0,-5,0, 0,5,0, 5,5,0, 5,10,0, -5,10,0, -5,-20,0
  ' 9
  DATA 11, 15,20,0, 15,-20,0, 5,-20,0, 5,10,0, -5,10,0, -5,5,0, 0,5,0, 0,-5,0, -10,-5,0, -15,0,0, -15,15,0, -10,20,0
  ' A
  DATA 13, -15,-20,0, -15,15,0, -10,20,0, 10,20,0, 15,15,0, 15,-20,0, 5,-20,0, 5,-5,0, 0,-5,0, 0,5,0, 5,5,0, 5,10,0, -5,10,0, -5,-20,0
  ' B
  DATA 18,-15,-20,0, -15,20,0, 10,20,0, 15,15,0, 15,5,0, 10,0,0, 15,-5,0, 15,-15,0, 10,-20,0, 0,-20,0, 0,-10,0, 5,-10,0, 5,-5,0, 0,-5,0, 0,5,0, 5,5,0, 5,10,0, -5,10,0, -5,-20,0
  ' C
  DATA 15, 15,5,0, 15,15,0, 10,20,0, -10,20,0, -15,15,0, -15,-15,0, -10,-20,0, 10,-20,0, 15,-15,0, 15,-5,0, 5,-5,0, 5,-10,0, -5,-10,0, -5,10,0, 5,10,0, 5,5,0
  ' D
  DATA 11, -15,-20,0, -15,20,0, 10,20,0, 15,15,0, 15,-15,0, 10,-20,0, 0,-20,0, 0,-10,0, 5,-10,0, 5,10,0, -5,10,0, -5,-20,0
  ' E
  DATA 11, 15,20,0, -15,20,0, -15,-20,0, 15,-20,0, 15,-10,0, -5,-10,0, -5,-5,0, 10,-5,0, 10,5,0, -5,5,0, -5,10,0, 15,10,0
  ' F
  DATA 9, 15,20,0, -15,20,0, -15,-20,0, -5,-20,0, -5,-5,0, 5,-5,0, 5,5,0, -5,5,0, -5,10,0, 15,10,0
  ' G
  DATA 13, 15,20,0, -10,20,0, -15,15,0, -15,-15,0, -10,-20,0, 15,-20,0, 15,5,0, 0,5,0, 0,-5,0, 5,-5,0, 5,-10,0, -5,-10,0, -5,10,0, 15,10,0
  ' H
  DATA 11, -15,-20,0, -15,20,0, -5,20,0, -5,5,0, 5,5,0, 5,20,0, 15,20,0, 15,-20,0, 5,-20,0, 5,-5,0, -5,-5,0, -5,-20,0
  ' I
  DATA 11, -15,20,0, 15,20,0, 15,10,0, 5,10,0, 5,-10,0, 15,-10,0, 15,-20,0, -15,-20,0, -15,-10,0, -5,-10,0, -5,10,0, -15,10,0
  ' J
  DATA 11, -15,20,0, 15,20,0, 15,-15,0, 10,-20,0, -10,-20,0, -15,-15,0, -15,0,0, -5,0,0, -5,-10,0, 5,-10,0, 5,10,0, -15,10,0
  ' K
  DATA 16, -15,-20,0, -15,20,0, -5,20,0, -5,5,0, 0,5,0, 5,10,0, 5,20,0, 15,20,0, 15,10,0, 5,0,0, 15,-10,0, 15,-20,0, 5,-20,0, 5,-10,0, 0,-5,0, -5,-5,0, -5,-20,0
  ' L
  DATA 5, -15,-20,0, -15,20,0, -5,20,0, -5,-10,0, 15,-10,0, 15,-20,0
  ' M
  DATA 11, -15,-20,0, -15,20,0, -5,20,0, 0,15,0, 5,20,0, 15,20,0, 15,-20,0, 5,-20,0, 5,5,0, 0,0,0, -5,5,0, -5,-20,0
  ' N
  DATA 9, -15,-20,0, -15,20,0, -5,20,0, 5,0,0, 5,20,0, 15,20,0, 15,-20,0, 5,-20,0, -5,0,0, -5,-20,0
  ' O
  DATA 13, -5,-20,0, -10,-20,0, -15,-15,0, -15,15,0, -10,20,0, 10,20,0, 15,15,0, 15,-15,0, 10,-20,0, 0,-20,0, 0,-10,0, 5,-10,0, 5,10,0, -5,10,0
  ' P
  DATA 11, -15,-20,0, -15,20,0, 10,20,0, 15,15,0, 15,0,0, 10,-5,0, 0,-5,0, 0,5,0, 5,5,0, 5,10,0, -5,10,0, -5,-20,0
  ' Q
  DATA 14, -5,-20,0, -10,-20,0, -15,-15,0, -15,15,0, -10,20,0, 10,20,0, 15,15,0, 15,-10,0, 20,-10,0, 20,-20,0, 0,-20,0, 0,-10,0, 5,-10,0, 5,10,0, -5,10,0
  ' R
  DATA 15, -15,-20,0, -15,20,0, 10,20,0, 15,15,0, 15,5,0, 10,0,0, 15,-5,0, 15,-20,0, 5,-20,0, 5,-5,0, 0,-5,0, 0,5,0, 5,5,0, 5,10,0, -5,10,0, -5,-20,0
  ' S
  DATA 15, -15,-20,0, -15,-10,0, 5,-10,0, 5,-5,0, -10,-5,0, -15,0,0, -15,15,0, -10,20,0, 15,20,0, 15,10,0, -5,10,0, -5,5,0, 10,5,0, 15,0,0, 15,-15,0, 10,-20,0
  ' T
  DATA 7, -15,20,0, 15,20,0, 15,10,0, 5,10,0, 5,-20,0, -5,-20,0, -5,10,0, -15,10,0
  ' U
  DATA 9, -15,20,0, -5,20,0, -5,-10,0, 5,-10,0, 5,20,0, 15,20,0, 15,-15,0, 10,-20,0, -10,-20,0, -15,-15,0
  ' V
  DATA 10, -15,20,0, -5,20,0, -5,5,0, 0,-5,0, 5,5,0, 5,20,0, 15,20,0, 15,0,0, 5,-20,0, -5,-20,0, -15,0,0
  ' W
  DATA 11, -15,20,0, -5,20,0, -5,-5,0, 0,0,0, 5,-5,0, 5,20,0, 15,20,0, 15,-20,0, 5,-20,0, 0,-15,0, -5,-20,0, -15,-20,0
  ' X
  DATA 11, -15,20,0, -5,20,0, 0,10,0, 5,20,0, 15,20,0, 5,0,0, 15,-20,0, 5,-20,0, 0,-10,0, -5,-20,0, -15,-20,0, -5,0,0
  ' Y
  DATA 12, -15,20,0, -5,20,0, -5,10,0, 0,5,0, 5,10,0, 5,20,0, 15,20,0, 15,5,0, 5,-5,0, 5,-20,0, -5,-20,0, -5,-5,0, -15,5,0
  ' Z
  DATA 9, -15,20,0, 15,20,0, 15,5,0, -5,-10,0, 15,-10,0, 15,-20,0, -15,-20,0, -15,-5,0, 5,10,0, -15,10,0
RETURN
