06601030305800
1
2#
F0110030
9[...................................................]001
ÄPROGRAMMATIONAVANCêEENGfA-BASIC(IV)
parDenebofFantasyetJediofSectorOnefromTHK

ApräsdelonguessemainesdepÇnibleattente,voicienfinle
quatriämeÇpisodedenotrefeuilleton.L'actionsepasseÖGfA-
Cityetlamissiondel'inspecteurconsisteÖdÇposerunsprite
danslesbanlieuesmalfrÇquentÇesdelamÇmoirevidÇo.Le
risqueestomniprÇsent,careneffetlespritenedoitenaucun
cassefairerepÇrerparlesoctetsquigardentlefond...

CACHE-CACHE

NousavonsvulemoisderniercommentdÇplacerunspritegrÉceÖ
latechniquedel'ÇcrituredirecteenmÇmoire-Çcran.Cependant,
celui-cialtÇraitlefond.Pourlaissertransparaitrel'arriäre-
planderriärenotremotif,ilfautrecourirÖlatechniquedes
caches(oumasques)quenousallonsÇtudier.
Leprincipeestsimple(heu...).Avantd'afficherlesprite
nousallonsdÇcoupersaformedanslefond.LaplaceÇtantlibre,
nousafficheronsalorslespriteensurimpression.LefondÇtant
noirci,lesconflictsentrecedernieretlemotifneserontque
demauvaissouvenirs.PourrÇaliserlapremiäreopÇration,la
meilleuresolutionconsisteÖutiliseruncache.PourlecrÇer,
ilfauteffacerlespriteenayantprÇalablementremplilereste
aveclacouleur15.LemasquedevraetreaffichÇenpremier,en
couplantlafonctionlogiqueANDÖl'instructiondetransfert(
CARDouLONG).Nousafficheronsensuitelespriteencouplant
cettefoislafonctionOR.

>>>INSERERSCHêMA"SCHEMA.NEO"<<<

UnederniäreprÇcisionavantdepassercommed'habitudeaux
travauxpratiques:latechniquedesmasquesn'estutilequedans
lamesureoólespriteetlefondutilisentdesplanscommuns.
Danslecascontraire,leslistingsdumoisdernierfonctionnent
Ölaperfection,leseulproblämeÇtantdecreerlapaletteafin
degerercorrectementlessuperpositiondesdeuxÇlÇments.Ce
serad'ailleursl'objetd'unprochainarticle.

HOOFDPROGRAMMA

Toutd'abord,je(Jedi)tientÖsignalerunpetitprobläme
concernantl'undeslistingsdel'articledunumÇro57.Dansle
programmechargÇdecalculerlesoffsetsdesBMOVEs,ilyadeux
occurrencessuccessivesdelaligne:

DECoterol%

Ilfautbienentenduremplacerl'undes'oterol%'par'hauteur%'
ettoutrentredansl'ordre.JetiensÖremercierODC(ofSector
One)pourm'avoirinformÇdecettepetiteerreurdefrappe.
Cecidit,enchainonsdirectementsurleslistings,encommenáant
auhasardparlepremier.Nousconstatonsaupremierabordqu'il
estlong(environ600lignes);jevousconseilleraisdoncde
ÄvouslevertrestìtetdevouscouchertrestardsivousdÇsirez
letaperdanssonintägralitÇ.Cependant,leslecteursassidus
remarquerontdenombreuxpointsaveclelistingdumois
prÇcÇdant.Eneffet,leprincipedelaprisedeblocdirectement
Ölasouris,ducalculdelacourbeetdelacrÇationdetousles
modulesnÇcessairesenunseulprogrammesembleavoirÇtÇ
unanimementapprÇciÇ.LesdeuxpremiäresphasescitÇesci-dessus
utilisentdonclesmàmesroutinesquelorsqu'ils'agissaitdes
spritesquiignoraientlefond.Enrevanche,les'.LST'qui
constituentlamajeurepartiedulistingn'ontplusrienÖvoir.
TÉchonsdelesdÇtaillerdansl'ordredanslequelilsse
prÇsentent.Lesdeuxpremiersontrespectivementpourbutde
sauvegarderetderestituerlefond,Öl'endroitoósetrouvait
lesprite.Ilexisteenfaitdeuxcouplesderoutinesbien
distinctes.Eneffet,lapremiäreutilisel'instructionBMOVE
afindesauverd'unseulcoupl'intägralitÇdeslignesoóse
trouvaitlesprite.L'avantagedecetteinstructionestde
prÇsenterunträsbonrapport'tailledusprite/tempsmachine'
danslecasoólespriteseraitrelativementÇtalÇ
horizontalement.LesecondtypederoutinesutilisÇnÇcessite
unefoisdeplusl'instructionLONGafindenesauvegarderle
fondquesurunetailleÇgaleÖcelledusprite.Avantage:cette
techniquemarcheträsbiensilesspritessonthautsetÇtroits.
InconvÇnient:ajoutequelquescentainesdelignesÖlalongueur
devotrelistingfinal.Jevousconseilled'essayerlesdeux
techniquesetdevoirÖchaquefoislaquelleestlaplus
avantageuse.AnoterqueleprogrammevousdemanderagentimentÖ
l'aided'uneboited'alertequellemÇthodevousdÇsirezadopter.
Letroisiäme'.LST'apourbutlareservationdesdeuxzones(
unepourchaqueÇcran)danslesquelleslefondserasauvegardÇ.
L'instructionMALLOCconvientparfaitementpourcetype
d'application(voirencadrÇ).
LedernierfichiermergablecrÇeestbienentendudestinÇÖ
l'affichageduspriteproprementdit.Lemasqueseradirectement
calculÇparblocsdeseizepixelsparsuperpositiondesquatre
plans(%1111=15,d'oólacouleur15dontilÇtaitquestionplus
haut).NouspourrionsensuitelecombinersanscesseavecunAND
puissuperposerlespriteavecunOR,maisdanslamoitiÇdes
cas,cesdeuxopÇrationssontinutiles.Ainsi,lorsquelemasque
estnul,lefondseraeffacÇdanssonintÇgralitÇ.Inutile
d'employerdesfonctionslogiquesdanscecas,lerÇsultatsera
identique.Demàme,lorsqu'unplanduspritecombleparfaitement
les'trous'queferaitlemasquedanslefond,lecacheest
inutileetununiqueORsuffit.Silescalculslogiquesvous
posentprobläme,nevousinquiÇtezpascarilsseronttraitÇs
dansunprochainarticle.Quoiqu'ilensoit,leprogrammefourni
iciaÇtÇÇtudiÇdefaáonÖgÇnÇrerlecodelepluscompactetle
plusrapidepossibleetvouspouvezluiaccordervotreentiäre
confiance.
LesecondlistingestunexemplesimplequidÇplaceunspritesur
uneimageNÇochromeenguised'arriäreplan.Iln'yapasgrand
choseÖprÇcisersurceprogramme.NÇanmoins,n'oubliezpasde
'merger'lesdiffÇrentsmodulescrÇesparlepremierlisting,de
chargerleINLINE,etdechangerlenomdufichierNÇochrome.
ÄCommetoujours,ceprogrammedoitàtrecompilÇpourtournerÖune
vitesseraisonnable.

>>>INSERERLISTING"LISTING1.LST"<<<

>>>INSERERLISTING"LISTING2.LST"<<<

C'ESTTOUT!

ApräsavoirÇtudiÇlessprites,nouspourronsaborder,telsdes
corsairesdÇchainÇs,lesscrollingsdetexteoud'image.D'ici
lÖ,sivousavezdesproblämesoudesidÇesÖnoussoumettre,
vouspouveztoujoursnouslaisserunsympathiquemessagesur
l'incommensurable3615STMAGenbalSECTORONE.

