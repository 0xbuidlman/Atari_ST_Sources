 dc.w $a00a
 lea $78000,a0
 move #$1f40,d0
jompa:
 clr.l (a0)+
 dbra d0,jompa 
main:
 clr.l -(sp)
 move.w #$20,-(sp)
 trap #1
 addq.l #6,sp
 move.l d0,pointeursuperviseur
 move.b $ff8201,d0
 lsl.w #8,d0
 move.b $ff8203,d0
 lsl.l #8,d0
 movea.l d0,a0
 move.b -$5f9,d5
 move.b -$5f7,d7
 clr.b -$5f9
 clr.b -$5f7
 move.b #2,$ff820a
 move.l $68,a0
 move.l $70,a6
 lea hbl(pc),a1
 move.l a1,$68
 lea vbl(pc),a1
 move.l a1,$70
 and.w #$f8ff,sr
 moveq.b #-1,d0          ; Sens de d‚placement de la barre
 moveq.b #0,d1            ; Positionnement de la barre
 lea tablesinus,a2
 suba.l a1,a1
finprovisoire:
 cmpi.b #$b9,$fffc02
 beq sortie
 cmpi.b #$39,$fffc02
 beq sortie
 jmp finprovisoire(pc)
hbl:                    ; Ne pas modifier les registres d5,d7,a0,a6
 dc.l $4e714e71
 addq #1,d2
 tst d3
 bne okay
 cmp d2,d1
 bne tanpi
 moveq #$d,d3
 lea barre,a1
okay:
 rept 85
 dc.w $4e71
 endr
 move (a1)+,$ff8240
 subq #1,d3
tanpi:
 rte
vbl:
 moveq #0,d2
 move.l (a2)+,d1
 move.l (a2)+,d1
 cmp #$fff,d1
 bne hop
 lea tablesinus,a2
 move (a2)+,d1
hop:
 rte
sortie:
 or.w #$300,sr
 move.b d7,-$5f7
 move.b d5,-$5f9
 move.l a0,$68
 move.l a6,$70
 and.w #$f8ff,sr          ; La couleur doit etre remise en ‚tat
 move #$777,$ff8240
 move.l pointeursuperviseur(pc),-(sp)
 move.w #$20,-(sp)
 trap #1
 addq.l #6,sp
 dc.w $a009
 clr.l -(a7)
 trap #1
pointeursuperviseur:
 dc.l 0
barre:
 dc.w 1,2,3,4,5,6,7,6,5,4,3,2,1
tablesinus:
 dc.w 152,154,156,158,160,162,164,166,168,170,172,174,176,178,180,182,184,186,188,190,192,193,195,197,199,201,203,205,207,208,210,212,214,215,217,219,221,222,224,226
 dc.w 227,229,230,232,234,235,237,238,240,241,243,244,245,247,248,249,251,252,253,254,256,257,258,259,260,261,262,263,264,265,266,267,268,269,269,270,271,272,272,273
 dc.w 274,274,275,275,276,276,277,277,277,278,278,278,279,279,279,279,279,279,279,279,279,279,279,279,279,279,279,279,278,278,278,277,277,277,276,276,275,275,274,274
 dc.w 273,272,272,271,270,269,269,268,267,266,265,264,263,262,261,260,259,258,257,256,254,253,252,251,249,248,247,245,244,243,241,240,238,237,235,234,232,230,229,227
 dc.w 226,224,222,221,219,217,215,214,212,210,208,207,205,203,201,199,197,195,193,192,190,188,186,184,182,180,178,176,174,172,170,168,166,164,162,160,158,156,154,152
 dc.w 152,150,148,146,144,142,140,138,136,134,132,130,128,126,124,122,120,118,116,114,112,111,109,107,105,103,101,99,97,96,94,92,90,89,87,85,83,82,80,78
 dc.w 77,75,74,72,70,69,67,66,64,63,61,60,59,57,56,55,53,52,51,50,48,47,46,45,44,43,42,41,40,39,38,37,36,35,35,34,33,32,32,31
 dc.w 30,30,29,29,28,28,27,27,27,26,26,26,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,26,26,26,27,27,27,28,28,29,29,30,30
 dc.w 31,32,32,33,34,35,35,36,37,38,39,40,41,42,43,44,45,46,47,48,50,51,52,53,55,56,57,59,60,61,63,64,66,67,69,70,72,74,75,77
 dc.w 78,80,82,83,85,87,89,90,92,94,96,97,99,101,103,105,107,109,111,112,114,116,118,120,122,124,126,128,130,132,134,136,138,140,142,144,146,148,150
 dc.l $fff0fff,$fff0fff
 end
