
Main:

	CLR.L	-(SP)
	MOVE	#$20,-(SP)
	TRAP	#1
	ADDQ	#6,SP

	CLR	-(SP)
	PEA	-1.W
	PEA	-1.W
	MOVE	#5,-(SP)
	TRAP	#14
	LEA	12(SP),SP

	MOVE.L	#FIN,$008.W
	MOVE.L	#FIN,$00C.W
	MOVE.L	#FIN,$010.W
	MOVE.L	#FIN,$014.W
	MOVE.L	#FIN,$018.W
	MOVE.L	#FIN,$01C.W
	MOVE.L	#FIN,$020.W

	MOVE.L	#VBL,$70.W

BOUCLE	BRA.S	BOUCLE

FIN	MOVE.L	4.W,A0
	JMP	(A0)

VBL
	MOVE.B	#$18,D0
	MOVE	#$2700,SR
SYNC	TST.B	$FFFF8209.W
	BEQ.S	SYNC
	SUB.B	$FFFF8209.W,D0
	LSR.L	D0,D0

	BSR	ROUTINE

	MOVE	#$2300,SR
	CMPI.B	#$39,$FFFFFC02.W
	BEQ.S	FIN
	RTE

ROUTINE
	LEA	BIDON,A0
	MOVE.L	A0,A1
	MOVE.L	A0,A2
	MOVE.L	A0,A3
	MOVE.L	A0,A4
	MOVE.L	A0,A5
	MOVE.L	A0,A6
	MOVEQ	#0,D0
	MOVEQ	#0,D1
	MOVEQ	#0,D2
	MOVEQ	#0,D3
	MOVEQ	#0,D4
	MOVEQ	#0,D5
	MOVEQ	#0,D6
	MOVEQ	#0,D7
	MOVE	#$700,$FFFF8240.W
N=9
	REPT	N
	NOP
	ENDR
	CLR	$FFFF8240.W

	REPT	120-N
	NOP
	ENDR

	MOVE	#$700,$FFFF8240.W
	;OR.B	D0,(A0,D0.W)	5
	;MOVE	(A0)+,D0	2
	;ADD	(A0)+,A0	3
	;ADD	(A0)+,D0	2
	;OR.B	D0,(A0)	3
	
	MOVEM	(A0)+,A1-A6	9
	;MOVE	(A0)+,A0	2
	;OR.B	D0,0(A0)	4

	;MOVE	D0,0(A0)	3
	CLR	$FFFF8240.W

	RTS

	BSS

BIDON	DS.L	1000

