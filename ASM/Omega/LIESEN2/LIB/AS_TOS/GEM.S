BEGIN:		BSR INITGEM
		RTS

******************************************
** INIT GEM ROUTINE
******************************************
INITGEM:	CLR.L AP1RESV
		CLR.L AP2RESV
		CLR.L AP3RESV
		CLR.L AP4RESV
		
		MOVE.W #10,OPCODE		; APPL_INIT
		CLR.W SINTIN
		MOVE.W #1,SINTOUT
		CLR.W SADDRIN
		CLR.W SADDROUT
		BSR.S AES
		
		MOVE.W #77,OPCODE		; GRAF_HANDLE
		CLR.W SINTIN
		MOVE.W #5,SINTOUT
		CLR.W SADDRIN
		CLR.W SADDROUT
		BSR.S AES

		MOVE.W INTOUT(PC),GRHANDLE

		MOVE.W #100,OPCODE		; OPEN_VWORK
		CLR.W CONTRL+2
		MOVE.W #11,CONTRL+6
		MOVE.W GRHANDLE(PC),CONTRL+12

		MOVEQ #9,D0
		LEA INTIN(PC),A0
TOLLEXY:	MOVE.W #1,(A0)+
		DBF D0,TOLLEXY
		MOVE.W #2,(A0)+
		BSR.S VDI
		RTS
**********************************************
***	GEM RUTINS
**********************************************
AES:		MOVE.L #AESPB,D1
		MOVE.W #$C8,D0
		TRAP #2
		RTS
VDI:		MOVE.L #VDIPB,D1
		MOVEQ #$73,D0
		TRAP #2
		RTS
**********************************************
***	GEM DATA
**********************************************
AESPB:		DC.L CONTRL,GLOBAL,INTIN,INTOUT,ADDRIN,ADDROUT
CONTRL:
OPCODE:		DC.W 0
SINTIN:		DC.W 0
SINTOUT:	DC.W 0
SADDRIN:	DC.W 0
SADDROUT:	DC.L 0
		BLK.W 5
GLOBAL:
APVERSION:	DC.W 0
APCOUNT:	DC.W 0
APID:		DC.W 0
APPRIVATE:	DC.L 0
AP1RESV:	DC.L 0
AP2RESV:	DC.L 0
AP3RESV:	DC.L 0
AP4RESV:	DC.L 0
INTIN:		BLK.W 128
PTSIN:		BLK.W 128
INTOUT:		BLK.W 128
PTSOUT:		BLK.W 128
ADDRIN:		BLK.W 128
ADDROUT:	BLK.W 128
VDIPB:		DC.L CONTRL,INTIN,PTSIN,INTOUT,PTSOUT
GRHANDLE:	DC.W 0


