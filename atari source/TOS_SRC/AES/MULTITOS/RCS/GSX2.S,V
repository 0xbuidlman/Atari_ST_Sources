head	1.10;
access;
symbols;
locks
	ersmith:1.10;
comment	@* @;


1.10
date	93.06.15.22.53.36;	author ersmith;	state Exp;
branches;
next	1.9;

1.9
date	93.06.14.23.48.02;	author ersmith;	state Exp;
branches;
next	1.8;

1.8
date	93.06.09.23.47.00;	author ersmith;	state Exp;
branches;
next	1.7;

1.7
date	93.05.12.15.50.18;	author ersmith;	state Exp;
branches;
next	1.6;

1.6
date	93.04.27.23.00.14;	author ersmith;	state Exp;
branches;
next	1.5;

1.5
date	93.04.14.22.19.54;	author ersmith;	state Exp;
branches;
next	1.4;

1.4
date	93.03.12.19.51.12;	author ersmith;	state Exp;
branches;
next	1.3;

1.3
date	93.03.10.20.12.42;	author ersmith;	state Exp;
branches;
next	1.2;

1.2
date	93.03.08.20.07.02;	author ersmith;	state Exp;
branches;
next	1.1;

1.1
date	93.02.24.23.52.46;	author ersmith;	state Exp;
branches;
next	1.0;

1.0
date	93.02.03.21.26.46;	author ersmith;	state Exp;
branches;
next	;


desc
@trap #2 bindings
@


1.10
log
@Minor resource editing, elclean ups, etc.
@
text
@*******************************************************************************
*
*	GSX2.S - GSX entry to GIOS and support for GSXBIND.C
*
* Author:
*	Steve Cavender
*
* Date:
*	1 October 1984
*
* Last Modified:
*	03 Oct 84
*	01 Nov 84 lkw
*	19 Jan 87 jde
*	
*
*******************************************************************************
*	Use MAC to assemble		6/28/90			D.Mui
*	Clean up			9/5/90			D.Mui

	.text

	.globl	_gsx2
	.globl	_mul_div
	.globl	_i_ptsin
	.globl	_i_intin
	.globl	_i_intout
	.globl	_i_ptsout
	.globl	_i_ptr
	.globl	_i_ptr2
	.globl	_i_lptr1
	.globl	_m_lptr2
	.globl	pblock
	.globl	iioff
	.globl	pioff
	.globl	iooff
	.globl	pooff
	.globl	_contrl


_gsx2:
	lea	pblock,a0	; a0 -> pblock
	move.l	#_contrl,(a0)	; set up control array pointer
	move.l	a0,d1		; d1 -> pblock
	moveq.l	#115, d0	; d0 <- VDI opcode
	trap	#2
	rts


*
*	mul_div( m1, m2, d1 )
*		WORD	m1,m2,d1

_mul_div:
	move.w	6(sp),d0	;	 m2
	add.w	d0,d0		;      2*m2
	muls	4(sp),d0	;   m1*2*m2
	divs	8(sp),d0	;  (m1*2*m2)/d1
	bmi	md_1

	addq.w	#1,d0		;  ((m1*2*m2)/d1)+1
	asr.w	#1,d0		; (((m1*2*m2)/d1)+1)/2
	rts

md_1:	subq.w	#1,d0		;  ((m1*2*m2)/d1)-1
	asr.w	#1,d0		; (((m1*2*m2)/d1)-1)/2
	rts


*_umul_div:
*
*	move.w	6(sp),d0	;         m2
*	add.w	d0,d0		;       2*m2
*	mulu	4(sp),d0	;    m1*2*m2
*	divu	8(sp),d0	;   (m1*2*m2)/d1
*	addq.w	#1,d0		;  ((m1*2*m2)/d1)+1
*	asr.w	#1,d0		; (((m1*2*m2)/d1)+1)/2
*	rts


_i_ptsin:

	move.l	4(sp),pioff
	rts


_i_intin:

	move.l	4(sp),iioff
	rts


_i_ptsout:

	move.l	4(sp),pooff
	rts


_i_intout:

	move.l	4(sp),iooff
	rts


_i_ptr:
_i_lptr1:

	move.l	4(sp),_contrl+14
	rts


_i_ptr2:

	move.l	4(sp),_contrl+18
	rts


_m_lptr2:

	move.l	4(sp),a0
	move.l	_contrl+18,(a0)
	rts



	.bss

pblock:	.ds.l	1
iioff:	.ds.l	1	; intin
pioff:	.ds.l	1	; intout
iooff:	.ds.l	1	; ptin
pooff:	.ds.l	1	; ptout

	.end
@


1.9
log
@Merged in Hans-Martin and Cary's changes
@
text
@@


1.8
log
@Another check in to save work.
@
text
@@


1.7
log
@Check in to save work
@
text
@@


1.6
log
@Merged Cary's and Hans-Martin's changes
@
text
@a0 30
*************************************************************************
*			Revision Control System
* =======================================================================
*  $Revision: 1.4 $	$Source: f:\multitos/RCS/gsx2.s,v $
* =======================================================================
*  $Author: ersmith $	$Date: 1993/03/12 19:51:12 $	$Locker: ersmith $
* =======================================================================
*  $Log: gsx2.s,v $
* Revision 1.4  1993/03/12  19:51:12  ersmith
* Merged HMK's loadable resource stuff
*
* Revision 1.3  1993/03/10  20:12:42  ersmith
* Lattice port
*
* Revision 1.1  1993/02/24  23:52:46  ersmith
* 1 meg floppy MultiTOS
*
* Revision 1.0  1993/02/03  21:26:46  ersmith
* MultiTOS version 1.0
*
* Revision 2.2  89/04/26  18:27:45  mui
* TT
* 
* Revision 2.1  89/02/22  05:30:14  kbad
* *** TOS 1.4  FINAL RELEASE VERSION ***
* 
* Revision 1.1  88/06/02  12:35:25  lozben
* Initial revision
* 
*************************************************************************
@


1.5
log
@Incorporated more single/multitasking changes.
@
text
@@


1.4
log
@Merged HMK's loadable resource stuff
@
text
@d4 1
a4 1
*  $Revision: 1.3 $	$Source: f:\multitos/RCS/gsx2.s,v $
d6 1
a6 1
*  $Author: ersmith $	$Date: 1993/03/10 20:12:42 $	$Locker: ersmith $
d9 3
@


1.3
log
@Lattice port
@
text
@d4 1
a4 1
*  $Revision: 1.0 $	$Source: i:\multitos/RCS/gsx2.s,v $
d6 1
a6 1
*  $Author: ersmith $	$Date: 1993/02/03 21:26:46 $	$Locker:  $
d8 4
a11 1
*  $Log:	gsx2.s,v $
@


1.2
log
@REAL MultiTOS 1.01
@
text
@d4 1
a4 1
*  $Revision: 1.1 $	$Source: f:\multitos/RCS/gsx2.s,v $
d6 1
a6 1
*  $Author: ersmith $	$Date: 1993/02/24 23:52:46 $	$Locker: ersmith $
d8 7
a14 4
*  $Log: gsx2.s,v $
# Revision 1.1  1993/02/24  23:52:46  ersmith
# 1 meg floppy MultiTOS
#
@


1.1
log
@1 meg floppy MultiTOS
@
text
@d4 1
a4 1
*  $Revision: 2.2 $	$Source: /u2/MRS/osrevisions/aes/gsx2.s,v $
d6 1
a6 1
*  $Author: mui $	$Date: 89/04/26 18:27:45 $	$Locker: kbad $
d8 4
a11 1
*  $Log:	gsx2.s,v $
@


1.0
log
@MultiTOS version 1.0
@
text
@@
